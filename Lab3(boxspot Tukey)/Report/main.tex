\documentclass[a4paper]{article}

\usepackage{mathtools} % математические формулы
\usepackage[T1,T2A]{fontenc} % кириллица
\usepackage[utf8]{inputenc} % кодировка шрифта кириллицы
\usepackage{indentfirst} %делать отступ в начале параграфа
\usepackage{enumerate} % нумерация списков
\usepackage{tabularx} % таблицы
\usepackage[english,russian]{babel} % вставка стороннего текста
\usepackage[12pt]{extsizes}
\usepackage{amsthm, amssymb, amsmath, amsfonts, nccmath, empheq}
\usepackage{color,colortbl} 
\usepackage[warn]{mathtext}
\usepackage{tocloft}  % для отточий в оглавлении
\linespread{1.5}
\usepackage{setspace} % для пробелов между линий
\usepackage{cmap}


\onehalfspacing
\usepackage{float}
\usepackage{graphicx}
\graphicspath{{pictures/}}
\DeclareGraphicsExtensions{.pdf,.png,.jpg}
\usepackage[left=25mm,right=25mm,
    top=2cm,bottom=30mm,bindingoffset=0cm]{geometry}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}

\usepackage{hyperref} % для гиперссылки на гитхаб

\author{Тырыкин Я. А. }
\date{March 2021}


\begin{document}
\begin{titlepage}
    \begin{center}
        \mbox{\normalsize{Санкт-Петербургский Политехнический Университет имени Петра Великого}}\\
        \normalsize{Институт Прикладной Математики и Механики}\\
        \large{\textbf{Кафедра "Прикладная Математика"}}
        
        \vfill
        
        \textbf{\Large{Отчет по лабораторной работе №3}}\\
        \textbf{\large{по дисциплине}}\\
        \textbf{\large"Математическая Статистика"}
        
        \vfill
        \raggedleft{Выполнил студент:}\\
        \raggedleft{Тырыкин Я. А.}\\
        \raggedleft{группа 3630102/80401}\\
        \raggedleft{Проверил:}\\
        \raggedleft{к.ф.-м.н., доцент}\\
        \raggedleft{Баженов А. Н.}\\
        
        % \normalsize{
        %     \begin{spacing}{0.5}
        %         \begin{tabular}{cc}
        %         Проверил: & \\\\ 
        %         к.ф.-м.н., доцент & Александр Николаевич Баженов \\\\
        %         Выполнил студент & \\\\
        %         группы 3630102/80401 & Ярослав Алексеевич Тырыкин \\\\
        %          \\\\
        %         \end{tabular}
        %     \end{spacing}
        % }\\
    
        
        \vfill
    
    \end{center}
    
    \begin{center} 
        Санкт-Петербург \\
        2021 
    \end{center}
\end{titlepage}
\newpage

% страница с оглавлением
% \renewcommand{\contentsname}{Оглавление} % можно поменять название оглавление
\begin{center}
    \tableofcontents
\end{center}
\setcounter{page}{2}
\newpage

% страница со списком графиков
\begin{center}
    \listoffigures
\end{center}
\newpage

% страница со списком таблиц 
\begin{center}
    \listoftabels
\end{center}
\newpage

\section{Постановка задачи}
 Для 5 распределений:
 \begin{enumerate}
    \begin{item}
            Нормальное распределение \textit{N}(\normalsize{\textit{x}}, \normalsize{0}, \normalsize{1})
        \end{item}
        \begin{item}
            Распределение Коши \textit{C}(\normalsize{\textit{x}}, \normalsize{0}, \normalsize{1})
        \end{item}
        \begin{item}
            Распределение Лапласа \textit{L}(\normalsize{\textit{x}}, \normalsize{0}, \scriptsize{\dfrac{1}{\sqrt{2}}})
        \end{item} 
        \begin{item} 
            Распределение Пуассона \textit{P}(\normalsize{\textit{k}}, \normalsize{10})
        \end{item}
        \begin{item}
            Равномерное распределение \textit{U}(\normalsize{\textit{x}}, \normalsize{$-$\sqrt{3}}, \normalsize{\sqrt{3}})
        \end{item}
 \end{enumerate}
 Необходимо сгенерировать выборки размером 10, 50 и 100
 элементов.
 Построить на одном рисунке гистограмму и график плотности распределения.
 
\section{Теория}
    \subsection{Распределения}
    \begin{itemize}
        \begin{item}
            Нормальное распределение:
        \end{item}
        \begin{equation}\label{norm}
            \textit{N}(\normalsize{\textit{x}}, \normalsize{0}, \normalsize{1}) = \dfrac{1}{\sqrt{2\pi}}e^{\frac{{-x}^2}{2}}
        \end{equation}
        
        \begin{item}
            Распределение Коши:
        \end{item}
        \begin{equation}\label{cauch}
            \textit{C}(\normalsize{\textit{x}}, \normalsize{0}, \normalsize{1}) = \dfrac{1}{\pi}\dfrac{1}{x^2+1}
        \end{equation} 
        
        \begin{item}
            Распределение Лапласа:
        \end{item}
        \begin{equation}\label{lapl}
            \textit{L}(\normalsize{\textit{x}}, \normalsize{0}, \normalsize{\dfrac{1}{\sqrt{2}}}) = \normalsize{\dfrac{1}{\sqrt{2}}e^{-\sqrt{2}|x|}}
        \end{equation}
        
        \begin{item}
            Распределение Пуассона:
        \end{item}
        \begin{equation}\label{pois}
            \textit{P}(\normalsize{\textit{k}}, \normalsize{10}) = \dfrac{10^\textit{k}}{\textit{k}!}e^{-10}
        \end{equation}
        
        \begin{item}
            Равномерное распределение:
        \end{item}
        \begin{equation}\label{unif}
            \textit{U}(\normalsize{\textit{x}}, \normalsize{-\sqrt{3}}, \normalsize{\sqrt{3}}) = \begin{cases}
                                            \dfrac{1}{2\sqrt{3}} & \text{при $|\textit{x}|\leq\sqrt{3}$}\\
                                            0 & \text{при $|\textit{x}| > \sqrt{3}$}\\
                                       \end{cases}
        \end{equation}
    \end{itemize}
    \subsection{Боксплот Тьюки}
        \subsubsection{Определение}
             Боксплот (англ. box plot) — график, использующийся в описательной статистике, компактно изображающий одномерное распределение вероятнос
        \subsubsection{Описание}
             Такой вид диаграммы в удобной форме показывает медиану, нижний и верхний квартили и выбросы. Несколько таких ящиков можно нарисовать бок
о бок, чтобы визуально сравнивать одно распределение с другим; их можно располагать как горизонтально, так и вертикально. Расстояния между
различными частями ящика позволяют определить степень разброса (дисперсии) и асимметрии данных и выявить выбросы.

        \subsubsection{Построение}
             Границами ящика служат первый и третий квартили, линия в середине
ящика — медиана. Концы усов — края статистически значимой выборки
(без выбросов). Длину «усов» определяют разность первого квартиля и полутора межквартильных расстояний и сумма третьего квартиля и полутора
межквартильных расстояний. Формула имеет вид
             \begin{equation} \label{borders}
                 X_1 = Q_1 - \dfrac{3}{2}(Q_3 - Q_1), X_2 = Q_3 + \dfrac{3}{2}(Q_3 - Q_1),
             \end{equation}
             где $X_1$ -- нижняя граница уса, $X_2$ -- верхняя граница уса, $Q_1$ -- первый квартиль, $Q_3$ -- третий квартиль.\\
             Данные, выходящие за границы усов (выбросы), отображаются на графике
в виде маленьких кружков.
    \subsection{Теоретическая вероятность выбросов}
        Встроенными средствами языка программирования R в среде разработки
RStudio можно вычислить теоретические первый и третий квартили распределений ($Q^T_1$ и $Q^T_3$ соответственно). По формуле \eqref{borders} можно вычислить теоретические нижнюю и верхнюю границы уса ($X^T_1$ и $X^T_2$ соответственно). Выбросами считаются величины \textit{x} такие, что:

        \begin{equation} \label{vibrosy}
            \left[
              \begin{array}{ccc}
                 x & < & X^T_1 \\
                 x & > & X^T_2 \\
              \end{array}
            \right.
        \end{equation}
        Теоретическая вероятность выбросов для непрерывных распределений
        \begin{equation}\label{nepreriv}
            P^T_B = P(x < X^T_1) + P(x > X^T_2) = F(X^T_1) + (1 - F(X^T_2)),
        \end{equation}
        где $F(X) = P(x \leq X)$ -- функция распределения.\\
        Теоретическая вероятность выбросов для дискретных распределений
        \begin{equation}\label{discret}
            P^T_B = P(x < X^T_1) + P(x > X^T_2) = (F(X^T_1) - P(x = X^T_1) ) + (1 - F(X^T_2)),
        \end{equation}
        где $F(X) = P(x \leq X)$ -- функция распределения.

\section{Модульная структура программы}
Лабораторная работа выполнена с применением средств языка Python версии 3.7 в среде разработки PyCharm IDE (в частности, с применением встроенных методов библиотеки SciPy и MatPlotLib). Исходной код лабораторной работы находится по ссылке в приложении к отчёту.
\section{Результаты}
    \subsection{Боксплот Тьюки}
        \begin{figure}[H]
            \centering
            \includegraphics[scale = 0.4]{Normal_boxplot.jpeg}
            \caption{Нормальное распределение \eqref{norm}}
            \label{fig:normal}
        \end{figure}
        
        \begin{figure}[H]
            \centering
            \includegraphics[scale = 0.4]{Cauchy_boxplot.jpeg}
            \caption{Распределение Коши \eqref{cauch}}
            \label{fig:cauchy}
        \end{figure}
        
        \begin{figure}[H]
            \centering
            \includegraphics[scale = 0.4]{Laplace_boxplot.jpeg}
            \caption{Распределение Лапласа \eqref{lapl}}
            \label{fig:laplace}
        \end{figure}
        
        \begin{figure}[H]
            \centering
            \includegraphics[scale = 0.4]{Poisson_boxplot.jpeg}
            \caption{Распределение Пуассона \eqref{pois}}
            \label{fig:poisson}
        \end{figure}
        
        \begin{figure}[H]
            \centering
            \includegraphics[scale = 0.4]{Uniform_boxplot.jpeg}
            \caption{Равномерное распределение \eqref{unif}}
            \label{fig:uniform}
        \end{figure}
    \subsection{Доля выбросов}
    
        \textit{Округление доли выбросов:}
        
        Выборка случайна, поэтому в качестве оценки рассеяния можно взять дисперсию пуассоновского потока: $D_n \approx \sqrt{n}$
        
        Доля $p_n = D_n / n = 1 / \sqrt{n}$
        
        Для $n = 20: p_n = 1 / \sqrt{20} -$ примерно $0.2$ или $20\%$
        
        Для $n = 100: p_n = 0.1$ или $10\%$
        
        Исходя из этого можно решить, сколько знаков оставлять в доле выбросов.
        
        
        \begin{table}[H]
            \centering
            \begin{tabular}{|c|c|c|c|c|c|}
                \hline
                 Выборвка & Доля выбросов \\ \hline
                 Normal n = 20 & 0.023\\ \hline
                 Normal n = 100 & 0.01\\ \hline
                 Cauchy n = 20 & 0.149\\ \hline
                 Cauchy n = 100 & 0.155\\ \hline
                 Laplace n = 20 & 0.075\\ \hline
                 Laplace n = 100 & 0.064\\ \hline
                 Poisson n = 20 & 0.024\\ \hline
                 Poisson n = 100 & 0.0099\\ \hline
                 Uniform n = 20 & 0.002\\ \hline
                 Uniform n = 100 & 0.0\\ \hline
    
            \end{tabular}
            \caption{Доля выбросов}
            \label{tab:vibrosy_fact}
        \end{table}
    
    \subsection{Теоретическая вероятность выбросов}

    \begin{table}[H]
        \centering
        \begin{tabular}{|c|c|c|c|c|c|}
            \hline
             Распределение & $Q^T_1$ & $Q^T_3$ & $X^T_1$ \eqref{borders} & $X^T_2$ \eqref{borders} & $P^T_B$ \eqref{nepreriv}, \eqref{discret} \\ \hline
             Нормальное распределение \eqref{norm} & -0.674 & 0.674 & -2.698 & 2.698 & 0.007\\ \hline
             Распределение Коши \eqref{cauch} & -1 & 1 & -4 & 4 & 0.156\\ \hline
             Распределение Лапласа \eqref{lapl} & -0.490 & 0.490 & -1.961 & 1.961 & 0.063\\ \hline
             Распределение Пуассона \eqref{pois} & 8 & 12 & 2 & 18 & 0.008\\ \hline
             Равномерное распределение \eqref{unif} & -0.866 & 0.866 & -3.464 & 3.464 & 0\\ \hline

             
        \end{tabular}
        \caption{Теоретическая вероятность выбросов}
        \label{tab:vibrosy_theory}
    \end{table}
    
    
\section{Обсуждение}
    \subsection{Гистограммы и графики распределений}
        По данным, приведенным в таблице, можно сказать, что чем больше выборка, тем ближе доля выбросов будет к теоретической оценке. Снова доля
выбросов для распределения Коши значительно выше, чем для остальных
распределений. Равномерное распределение же в точности повторяет теоретическую оценку - выбросов мы не получали.

        Боксплоты Тьюки действительно позволяют более наглядно и с меньшими
усилиями оценивать важные характеристики распределений. Так, исходя
из полученных рисунков, наглядно видно то, что мы довольно трудоёмко
анализировали в предыдущих частях.
\section{Ресурсы}
    \begin{spacing}{2.5}
        Код программы, реализующей отрисовку обозначенных распределений:
        
        \href{https://github.com/YaroslavAggressive/Mathematical-statistics-lab-works}{https://github.com/YaroslavAggressive/Mathematical-statistics-lab-works}
    \end{spacing}
\end{document}
